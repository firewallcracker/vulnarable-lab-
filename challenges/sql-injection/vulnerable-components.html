<!DOCTYPE html>
<html>
<head>
    <title>A06: Vulnerable Components</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 600px; margin: 50px auto; padding: 20px; }
        .container { background: #f9f9f9; padding: 30px; border-radius: 8px; }
        .component-info { background: white; padding: 20px; margin: 15px 0; border-radius: 8px; border: 1px solid #ddd; }
        .vulnerable { border-left: 5px solid #e74c3c; background: #fdf2f2; }
        .version { font-family: monospace; background: #f8f9fa; padding: 5px; border-radius: 3px; }
        button { background: #007cba; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; margin: 5px; }
        .hint { background: #fff3cd; color: #856404; border: 1px solid #ffeaa7; margin-top: 20px; padding: 15px; border-radius: 4px; }
        .exploit-result { background: #000; color: #0f0; padding: 15px; margin: 15px 0; border-radius: 4px; font-family: monospace; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üì¶ A06: Vulnerable Components</h1>
        <p>System Component Information</p>
        
        <div class="component-info vulnerable">
            <h3>‚ö†Ô∏è jQuery Library</h3>
            <p>Version: <span class="version">1.4.2</span> (Released: 2010)</p>
            <p>Status: <strong style="color: red;">VULNERABLE</strong></p>
            <p>Known CVEs: CVE-2011-4969, CVE-2012-6708</p>
            <button onclick="exploitJQuery()">Test jQuery Exploit</button>
        </div>
        
        <div class="component-info">
            <h3>‚úÖ Bootstrap CSS</h3>
            <p>Version: <span class="version">5.1.3</span></p>
            <p>Status: <strong style="color: green;">UP TO DATE</strong></p>
        </div>
        
        <div class="component-info vulnerable">
            <h3>‚ö†Ô∏è Lodash Utility</h3>
            <p>Version: <span class="version">4.17.4</span></p>
            <p>Status: <strong style="color: red;">VULNERABLE</strong></p>
            <p>Known CVEs: CVE-2019-10744, CVE-2020-8203</p>
            <button onclick="exploitLodash()">Test Lodash Exploit</button>
        </div>
        
        <div class="component-info vulnerable">
            <h3>‚ö†Ô∏è Express.js Framework</h3>
            <p>Version: <span class="version">3.21.2</span></p>
            <p>Status: <strong style="color: red;">OUTDATED</strong></p>
            <p>Security Issues: Multiple vulnerabilities in old version</p>
            <button onclick="exploitExpress()">Test Express Exploit</button>
        </div>
        
        <div id="exploitOutput" class="exploit-result" style="display: none;"></div>
        
        <div class="hint">
            <h3>üí° Hints:</h3>
            <ul>
                <li><strong>Beginner:</strong> Look for components marked as VULNERABLE</li>
                <li><strong>Intermediate:</strong> Try exploiting the jQuery 1.4.2 vulnerability</li>
                <li><strong>Advanced:</strong> Old versions often have known security flaws</li>
            </ul>
        </div>
        
        <div class="hint">
            <h3>üéØ Objective:</h3>
            <p>Exploit vulnerable third-party components to find the flag.</p>
        </div>
    </div>

    <script>
        const flag = 'SKILLLAB{vuln3r4bl3_c0mp0n3nts}';
        
        function exploitJQuery() {
            // Simulate jQuery 1.4.2 XSS vulnerability
            const output = document.getElementById('exploitOutput');
            output.innerHTML = `
<strong>jQuery 1.4.2 Exploit Successful!</strong>

Vulnerability: CVE-2011-4969 - XSS in jQuery selector
Payload: $("&lt;img src=x onerror=alert('XSS')&gt;")

Exploitation Result:
- DOM manipulation successful
- XSS payload executed
- Flag retrieved: ${flag}

Recommendation: Update to jQuery 3.6.0 or later
            `;
            output.style.display = 'block';
        }
        
        function exploitLodash() {
            const output = document.getElementById('exploitOutput');
            output.innerHTML = `
<strong>Lodash 4.17.4 Exploit Attempted</strong>

Vulnerability: CVE-2019-10744 - Prototype Pollution
Status: Partially successful

This version is vulnerable to prototype pollution attacks.
Update to Lodash 4.17.21 or later to fix this issue.

Flag hint: Check the jQuery exploit instead.
            `;
            output.style.display = 'block';
        }
        
        function exploitExpress() {
            const output = document.getElementById('exploitOutput');
            output.innerHTML = `
<strong>Express.js 3.21.2 Analysis</strong>

Multiple vulnerabilities found:
- Directory traversal (CVE-2017-14849)
- Open redirect vulnerabilities
- Denial of service issues

Status: Exploitation requires server-side access
Recommendation: Upgrade to Express 4.18.0 or later

For client-side flags, try the jQuery exploit.
            `;
            output.style.display = 'block';
        }
        
        // Simulate vulnerable jQuery 1.4.2 behavior
        window.$ = function(selector) {
            if (typeof selector === 'string' && selector.includes('<')) {
                // VULNERABLE: No proper sanitization in old jQuery
                console.log('Vulnerable jQuery selector detected:', selector);
                return {
                    html: function(content) {
                        if (content && content.includes('flag')) {
                            return flag;
                        }
                        return content;
                    }
                };
            }
            return document.querySelector(selector);
        };
    </script>
</body>
</html>